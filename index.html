<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FF Info Hub - Free Fire Stats</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cyber-bg': '#0d1117',
                        'cyber-card': 'rgba(20, 30, 50, 0.7)',
                        'cyber-neon': '#00ffcc',
                        'cyber-purple': '#d400ff',
                        'cyber-success': '#00ff88',
                        'cyber-error': '#ff3366',
                        'cyber-light': '#e6f3ff',
                    },
                    fontFamily: {
                        headline: ['Orbitron', 'sans-serif'],
                        mono: ['Roboto Mono', 'monospace'],
                    },
                    keyframes: {
                        neonGlow: {
                            '0%, 100%': { boxShadow: '0 0 10px rgba(0, 255, 204, 0.5), 0 0 20px rgba(0, 255, 204, 0.3)' },
                            '50%': { boxShadow: '0 0 20px rgba(0, 255, 204, 0.8), 0 0 40px rgba(0, 255, 204, 0.5)' },
                        },
                        ripple: {
                            '0%': { transform: 'scale(0)', opacity: '0.5' },
                            '100%': { transform: 'scale(4)', opacity: '0' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-8px)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                    },
                    animation: {
                        'neon-glow': 'neonGlow 2s ease-in-out infinite',
                        'ripple': 'ripple 0.6s ease-out',
                        'float': 'float 4s ease-in-out infinite',
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                    },
                }
            }
        }
    </script>
    <style>
        body {
            @apply bg-cyber-bg text-white font-mono min-h-screen flex flex-col relative overflow-hidden;
        }

        body.light {
            @apply bg-cyber-light text-gray-900;
        }

        .cyber-bg {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at top left, rgba(0, 255, 204, 0.1), transparent 50%),
                        radial-gradient(circle at bottom right, rgba(212, 0, 255, 0.1), transparent 50%);
            z-index: -1;
        }

        .particles {
            position: absolute;
            inset: 0;
            background-image: radial-gradient(circle, rgba(0, 255, 204, 0.2) 1px, transparent 1px);
            background-size: 20px 20px;
            animation: float 10s linear infinite;
            opacity: 0.3;
        }

        .cyber-card {
            @apply bg-cyber-card backdrop-blur-lg border border-cyber-neon/30 rounded-lg p-6;
            transition: all 0.3s ease;
        }

        .cyber-card:hover {
            @apply border-cyber-purple/50;
            transform: translateY(-3px);
        }

        .btn-cyber {
            @apply relative overflow-hidden bg-gradient-to-r from-cyber-neon to-cyber-purple text-white font-bold rounded-lg px-6 py-3 uppercase tracking-wide;
            animation: neon-glow 2s ease-in-out infinite;
        }

        .btn-cyber::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s;
        }

        .btn-cyber:hover::after {
            animation: ripple 0.6s ease-out;
        }

        .btn-cyber:hover {
            @apply scale-105;
        }

        .input-cyber {
            @apply w-full p-3 bg-cyber-card border-2 border-cyber-neon/50 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-cyber-purple/80;
            transition: all 0.3s ease;
        }

        .input-cyber:focus {
            @apply animate-neon-glow bg-cyber-card/80;
        }

        .select-cyber {
            @apply input-cyber appearance-none pr-10;
        }

        .hex-card {
            @apply relative bg-cyber-card border border-cyber-neon/30 text-center p-4 rounded-[12px] transition-all duration-300;
            clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
        }

        .hex-card:hover {
            @apply border-cyber-purple/50 scale-105;
            box-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
        }

        .skeleton-cyber {
            @apply bg-gradient-to-r from-gray-800 via-cyber-card to-gray-800 rounded-lg;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .avatar-glow {
            @apply relative;
        }

        .avatar-glow::before {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            background: linear-gradient(45deg, #00ffcc, #d400ff);
            opacity: 0.5;
            animation: neon-glow 2s ease-in-out infinite;
        }

        .suggest-dropdown {
            @apply absolute w-full bg-cyber-card border border-cyber-neon/30 rounded-lg mt-2 max-h-60 overflow-y-auto z-20 animate-fade-in;
        }

        .suggest-item {
            @apply px-4 py-2 hover:bg-cyber-purple/20 flex items-center space-x-3 transition-colors;
        }

        .toast-cyber {
            @apply fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in;
        }

        .error-box {
            @apply cyber-card p-8 text-center animate-fade-in;
        }

        .empty-box {
            @apply cyber-card p-8 text-center animate-fade-in;
        }

        footer {
            @apply mt-auto text-center py-6 text-gray-500 text-sm font-mono;
        }
    </style>
    <!-- Vanilla Tilt for 3D card effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.2/vanilla-tilt.min.js"></script>
    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel CDN -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div class="cyber-bg">
        <div class="particles"></div>
    </div>
    <div id="root" class="container mx-auto px-4 py-8 flex-1"></div>
    <footer>Developed By SAKIB HOSSAIN</footer>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const SERVERS = ['BD', 'IND', 'SG', 'RU', 'ID', 'TW', 'US', 'VN', 'TH', 'ME', 'PK', 'CIS', 'BR'];

        const Header = ({ toggleTheme, isLight }) => (
            <header className="flex justify-between items-center mb-8 animate-fade-in">
                <h1 className="text-4xl font-headline font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyber-neon to-cyber-purple">
                    FF Info Hub
                </h1>
                <button onClick={toggleTheme} className="cyber-card p-2">
                    {isLight ? (
                        <svg className="w-6 h-6 text-gray-800" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                        </svg>
                    ) : (
                        <svg className="w-6 h-6 text-cyber-neon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 11-2 0 1 1 0 012 0zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 11-2 0 1 1 0 012 0z"></path>
                        </svg>
                    )}
                </button>
            </header>
        );

        const SearchBar = ({ uid, setUid, server, setServer, onSearch, isLoading, recentSearches, showSuggestions, setShowSuggestions }) => {
            const ref = useRef();

            useEffect(() => {
                VanillaTilt.init(document.querySelectorAll('.tilt-card'), {
                    max: 15,
                    speed: 400,
                    glare: true,
                    'max-glare': 0.5,
                });
                const handleClickOutside = (e) => {
                    if (ref.current && !ref.current.contains(e.target)) setShowSuggestions(false);
                };
                document.addEventListener('click', handleClickOutside);
                return () => document.removeEventListener('click', handleClickOutside);
            }, []);

            const handleUidChange = (e) => {
                setUid(e.target.value);
                setShowSuggestions(e.target.value.length > 0);
                setServer('BD'); // Auto-select BD on UID input
            };

            return (
                <div className="cyber-card tilt-card mb-8" ref={ref}>
                    <div className="mb-6">
                        <label className="block text-sm font-bold mb-2 text-cyber-neon">Player UID</label>
                        <input
                            type="text"
                            className="input-cyber"
                            placeholder="Enter UID (e.g., 8035061359)"
                            value={uid}
                            onChange={handleUidChange}
                            disabled={isLoading}
                        />
                        {showSuggestions && recentSearches.length > 0 && (
                            <div className="suggest-dropdown">
                                {recentSearches.map((s, i) => (
                                    <button
                                        key={i}
                                        onClick={() => { setUid(s.uid); setServer(s.server); setShowSuggestions(false); onSearch(); }}
                                        className="suggest-item"
                                    >
                                        <img src={s.avatar} alt="" className="w-8 h-8 rounded-full" />
                                        <span>{s.nickname} ({s.uid}) - {s.server}</span>
                                    </button>
                                ))}
                            </div>
                        )}
                    </div>
                    <div className="mb-6">
                        <label className="block text-sm font-bold mb-2 text-cyber-neon">Server</label>
                        <div className="relative">
                            <select className="select-cyber" value={server} onChange={(e) => setServer(e.target.value)} disabled={isLoading}>
                                {SERVERS.map(s => <option key={s} value={s}>{s}</option>)}
                            </select>
                            <svg className="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-cyber-neon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </div>
                    </div>
                    <button onClick={onSearch} disabled={isLoading || !uid} className="btn-cyber w-full disabled:opacity-50">
                        {isLoading ? (
                            <svg className="animate-spin w-5 h-5 mx-auto" fill="none" viewBox="0 0 24 24">
                                <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        ) : (
                            'Search Player'
                        )}
                    </button>
                </div>
            );
        };

        const PlayerCard = ({ player }) => (
            <div className="cyber-card tilt-card p-8 mb-8 text-center" data-tilt>
                <div className="avatar-glow mb-4">
                    <img src={player.avatar} alt={player.nickname} className="w-28 h-28 rounded-full mx-auto" />
                </div>
                <h2 className="text-3xl font-headline font-bold text-cyber-neon mb-2">{player.nickname}</h2>
                <p className="text-lg text-gray-400 mb-4">Level: {player.level}</p>
                <div className="flex items-center justify-center gap-4">
                    <img src={player.rankImg} alt="Rank" className="w-12 h-12 rounded-full" />
                    <span className="text-xl font-bold text-cyber-purple">{player.rankName}</span>
                </div>
            </div>
        );

        const StatsGrid = ({ stats }) => (
            <div className="grid grid-cols-2 md:grid-cols-3 gap-6 mb-8">
                {[
                    { label: 'Matches', value: stats.matches, icon: '🎮' },
                    { label: 'Wins', value: stats.wins, icon: '🏆' },
                    { label: 'Kills', value: stats.kills, icon: '💀' },
                    { label: 'K/D', value: stats.kdRatio, icon: '⚔️' },
                    { label: 'Win Rate', value: stats.winRate, icon: '📊' },
                    { label: 'Headshots', value: stats.headshots, icon: '🎯' },
                ].map((s, i) => (
                    <div key={i} className="hex-card tilt-card" data-tilt>
                        <span className="text-2xl mb-2 block">{s.icon}</span>
                        <p className="text-sm text-gray-400 uppercase">{s.label}</p>
                        <p className="text-xl font-bold text-cyber-neon">{s.value}</p>
                    </div>
                ))}
            </div>
        );

        const LoadingSkeleton = () => (
            <div className="cyber-card p-8 mb-8">
                <div className="skeleton-cyber w-28 h-28 rounded-full mx-auto mb-4"></div>
                <div className="skeleton-cyber h-6 w-3/4 mx-auto mb-2"></div>
                <div className="skeleton-cyber h-4 w-1/2 mx-auto mb-4"></div>
                <div className="grid grid-cols-2 md:grid-cols-3 gap-6">
                    {[...Array(6)].map((_, i) => (
                        <div key={i} className="skeleton-cyber p-4 rounded-[12px]" style={{ clipPath: 'polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)' }}>
                            <div className="skeleton-cyber h-8 w-8 mx-auto mb-2 rounded-full"></div>
                            <div className="skeleton-cyber h-4 w-2/3 mx-auto"></div>
                            <div className="skeleton-cyber h-6 w-1/2 mx-auto mt-2"></div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const ErrorState = ({ error, retry }) => (
            <div className="error-box">
                <svg className="w-16 h-16 mx-auto mb-4 text-cyber-error" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <h3 className="text-2xl font-headline font-bold text-cyber-error mb-4">Data Not Found</h3>
                <p className="text-gray-400 mb-6">{error || 'Please check UID and server.'}</p>
                <button onClick={retry} className="btn-cyber">Try Again</button>
            </div>
        );

        const EmptyState = ({ recentSearches, onRecentClick }) => (
            <div className="empty-box">
                <svg className="w-20 h-20 mx-auto mb-6 text-cyber-neon animate-float" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
                <h3 className="text-2xl font-headline font-bold text-cyber-neon mb-4">Search for Epic Stats!</h3>
                <p className="text-gray-400 mb-6">Enter a Free Fire UID to begin.</p>
                {recentSearches.length > 0 && (
                    <div className="mt-6">
                        <h4 className="text-lg font-bold mb-4 text-cyber-purple">Recent Searches</h4>
                        <div className="space-y-3">
                            {recentSearches.map((s, i) => (
                                <button
                                    key={i}
                                    onClick={() => onRecentClick(s.uid, s.server)}
                                    className="suggest-item w-full text-left"
                                >
                                    <img src={s.avatar} alt="" className="w-8 h-8 rounded-full" />
                                    <span>{s.nickname} ({s.uid}) - {s.server}</span>
                                </button>
                            ))}
                        </div>
                    </div>
                )}
            </div>
        );

        const Toast = ({ message, type, show }) => {
            if (!show) return null;
            return (
                <div className={`toast-cyber ${type === 'success' ? 'bg-gradient-to-r from-cyber-success to-cyber-neon' : 'bg-gradient-to-r from-cyber-error to-cyber-purple'}`}>
                    {message}
                </div>
            );
        };

        const App = () => {
            const [uid, setUid] = useState('');
            const [server, setServer] = useState('BD');
            const [player, setPlayer] = useState(null);
            const [stats, setStats] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);
            const [toast, setToast] = useState({ show: false, message: '', type: '' });
            const [recentSearches, setRecentSearches] = useState([]);
            const [showSuggestions, setShowSuggestions] = useState(false);
            const [isLight, setIsLight] = useState(false);

            useEffect(() => {
                const savedTheme = localStorage.getItem('theme') === 'light';
                setIsLight(savedTheme);
                document.body.classList.toggle('light', savedTheme);
                const savedSearches = localStorage.getItem('ff_recent_searches');
                if (savedSearches) setRecentSearches(JSON.parse(savedSearches));
            }, []);

            const toggleTheme = () => {
                const newTheme = !isLight;
                setIsLight(newTheme);
                document.body.classList.toggle('light', newTheme);
                localStorage.setItem('theme', newTheme ? 'light' : 'dark');
            };

            const showToast = (message, type = 'success') => {
                setToast({ show: true, message, type });
                setTimeout(() => setToast({ show: false, message: '', type: '' }), 3000);
            };

            const addRecentSearch = (player) => {
                const newSearch = { uid: player.uid, nickname: player.nickname, avatar: player.avatar, server };
                const updated = [newSearch, ...recentSearches.filter(s => s.uid !== player.uid)].slice(0, 5);
                setRecentSearches(updated);
                localStorage.setItem('ff_recent_searches', JSON.stringify(updated));
            };

            const fetchPlayer = async () => {
                if (!uid) {
                    showToast('Please enter a UID', 'error');
                    return;
                }
                setError(null);
                setPlayer(null);
                setStats(null);
                setIsLoading(true);

                try {
                    const personalUrl = `https://ff-info-gajarbotol.vercel.app/get_player_personal_show?server=${server}&uid=${uid}`;
                    const personalRes = await fetch(personalUrl);
                    const personalData = await personalRes.json();
                    if (!personalRes.ok || personalData.status === false) {
                        throw new Error(personalData.msg || 'Player not found');
                    }

                    const playerInfo = {
                        uid: personalData.uid,
                        nickname: personalData.nickname,
                        level: personalData.level,
                        avatar: personalData.avatar_url || 'https://via.placeholder.com/128/00ffcc/ffffff?text=AV',
                        rankImg: personalData.rank_badge_url || 'https://via.placeholder.com/48/d400ff/fff?text=R',
                        rankName: personalData.rank_name || 'N/A',
                    };
                    setPlayer(playerInfo);
                    addRecentSearch(playerInfo);

                    const statsUrl = `https://ff-info-gajarbotol.vercel.app/get_player_stats?server=${server}&uid=${uid}&matchmode=RANKED&gamemode=br`;
                    const statsRes = await fetch(statsUrl);
                    const statsData = await statsRes.json();
                    if (!statsRes.ok || statsData.status === false) {
                        throw new Error(statsData.msg || 'Stats not available');
                    }

                    const brStats = statsData.br_ranked_stats || {};
                    setStats({
                        matches: brStats.matches_played || 0,
                        wins: brStats.wins || 0,
                        kills: brStats.kills || 0,
                        kdRatio: brStats.kd_ratio ? brStats.kd_ratio.toFixed(2) : '0.00',
                        winRate: brStats.win_rate ? `${brStats.win_rate.toFixed(1)}%` : '0%',
                        headshots: brStats.headshots || 0,
                    });

                    showToast(`Loaded stats for ${playerInfo.nickname}`);
                } catch (err) {
                    setError(err.message);
                    showToast(err.message, 'error');
                } finally {
                    setIsLoading(false);
                }
            };

            const handleRecentClick = (uid, server) => {
                setUid(uid);
                setServer(server);
                fetchPlayer();
            };

            return (
                <div>
                    <Header toggleTheme={toggleTheme} isLight={isLight} />
                    <Toast {...toast} />
                    <SearchBar
                        uid={uid}
                        setUid={setUid}
                        server={server}
                        setServer={setServer}
                        onSearch={fetchPlayer}
                        isLoading={isLoading}
                        recentSearches={recentSearches}
                        showSuggestions={showSuggestions}
                        setShowSuggestions={setShowSuggestions}
                    />
                    {isLoading ? (
                        <LoadingSkeleton />
                    ) : error ? (
                        <ErrorState error={error} retry={fetchPlayer} />
                    ) : player && stats ? (
                        <>
                            <PlayerCard player={player} />
                            <StatsGrid stats={stats} />
                            <div className="flex flex-col sm:flex-row gap-4 justify-center mb-8">
                                <button
                                    onClick={() => {
                                        navigator.clipboard.writeText(player.uid);
                                        showToast('UID copied!');
                                    }}
                                    className="btn-cyber flex items-center justify-center gap-2"
                                >
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m-4 3v1h-2M8 10h.01M12 10h.01M16 10h.01M8 14h.01M12 14h.01M16 14h.01"></path>
                                    </svg>
                                    Copy UID
                                </button>
                                <button
                                    onClick={() => {
                                        if (navigator.share) {
                                            navigator.share({
                                                title: `${player.nickname}'s Stats`,
                                                text: `Check out ${player.nickname}'s Free Fire stats!`,
                                                url: window.location.href,
                                            });
                                        } else {
                                            showToast('Share not supported', 'error');
                                        }
                                    }}
                                    className="btn-cyber flex items-center justify-center gap-2"
                                >
                                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684zm0 0a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                                    </svg>
                                    Share Profile
                                </button>
                            </div>
                        </>
                    ) : (
                        <EmptyState recentSearches={recentSearches} onRecentClick={handleRecentClick} />
                    )}
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
