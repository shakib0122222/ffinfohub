<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Fire Player Info</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .container {
            max-width: 800px;
        }
        .card {
            margin-top: 20px;
        }
        .loader {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4">Free Fire Player Info</h1>
        <form id="playerForm">
            <div class="mb-3">
                <label for="server" class="form-label">Server</label>
                <select id="server" class="form-select" required>
                    <option value="">Select Server</option>
                    <option value="IND">IND</option>
                    <option value="SG">SG</option>
                    <option value="RU">RU</option>
                    <option value="ID">ID</option>
                    <option value="TW">TW</option>
                    <option value="US">US</option>
                    <option value="VN">VN</option>
                    <option value="TH">TH</option>
                    <option value="ME">ME</option>
                    <option value="PK">PK</option>
                    <option value="CIS">CIS</option>
                    <option value="BR">BR</option>
                    <option value="BD">BD</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="uid" class="form-label">UID</label>
                <input type="text" id="uid" class="form-control" required placeholder="Enter UID (e.g., 8035061359)">
            </div>
            <div class="mb-3">
                <label for="matchmode" class="form-label">Match Mode</label>
                <select id="matchmode" class="form-select" required>
                    <option value="RANKED">RANKED</option>
                    <option value="CLASSIC">CLASSIC</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="gamemode" class="form-label">Game Mode</label>
                <select id="gamemode" class="form-select" required>
                    <option value="br">Battle Royale (br)</option>
                    <option value="cs">Clash Squad (cs)</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary w-100">Get Player Info</button>
        </form>

        <div class="loader">
            <div class="spinner-border text-primary" role="status"></div>
            <p>Loading...</p>
        </div>

        <div id="results" class="row"></div>
    </div>

    <script>
        const baseUrl = 'https://ff-info-gajarbotol.vercel.app/';

        document.getElementById('playerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const server = document.getElementById('server').value;
            const uid = document.getElementById('uid').value;
            const matchmode = document.getElementById('matchmode').value;
            const gamemode = document.getElementById('gamemode').value;

            if (!server || !uid) {
                alert('Please select server and enter UID.');
                return;
            }

            const loader = document.querySelector('.loader');
            loader.style.display = 'block';
            const results = document.getElementById('results');
            results.innerHTML = '';

            try {
                // Fetch Personal Info
                const personalRes = await fetch(`${baseUrl}get_player_personal_show?server=${server}&uid=${uid}`);
                const personalData = await personalRes.json();

                // Fetch Stats
                const statsRes = await fetch(`${baseUrl}get_player_stats?server=${server}&uid=${uid}&matchmode=${matchmode}&gamemode=${gamemode}`);
                const statsData = await statsRes.json();

                // Display Personal Info
                const personalCard = createInfoCard('Personal Info', personalData);
                results.appendChild(personalCard);

                // Display Stats
                const statsCard = createInfoCard('Player Stats', statsData);
                results.appendChild(statsCard);

            } catch (error) {
                results.innerHTML = `<div class="col-12"><div class="card text-center"><div class="card-body"><h5 class="card-title">Error</h5><p class="card-text">Failed to fetch data. Please check UID and try again.</p></div></div></div>`;
            } finally {
                loader.style.display = 'none';
            }
        });

        function createInfoCard(title, data) {
            const col = document.createElement('div');
            col.className = 'col-md-6';
            const card = document.createElement('div');
            card.className = 'card';
            const cardBody = document.createElement('div');
            cardBody.className = 'card-body';
            const cardTitle = document.createElement('h5');
            cardTitle.className = 'card-title';
            cardTitle.textContent = title;
            cardBody.appendChild(cardTitle);

            if (data.success === false || data.status === 'error') {
                const errorP = document.createElement('p');
                errorP.className = 'card-text text-danger';
                errorP.textContent = data.message || data.error;
                cardBody.appendChild(errorP);
            } else {
                const list = document.createElement('ul');
                list.className = 'list-group list-group-flush';
                for (const [key, value] of Object.entries(data)) {
                    const item = document.createElement('li');
                    item.className = 'list-group-item';
                    item.textContent = `${key}: ${typeof value === 'object' ? JSON.stringify(value) : value}`;
                    list.appendChild(item);
                }
                cardBody.appendChild(list);
            }

            card.appendChild(cardBody);
            col.appendChild(card);
            return col;
        }
    </script>
</body>
</html>
